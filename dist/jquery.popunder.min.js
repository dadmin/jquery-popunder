/*! jquery-plugin to create popunder in major browsers. This is commonjs implemetation, 0.4.1 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2019 Hans-Peter Buniat, BSD-3-Clause license */

!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),window,screen,navigator,document):t(jQuery,window,screen,navigator,document)}(function(a,c,t,e,n){"use strict";return a.popunder=function(t,e,n,i){var o=a.popunder.helper;if(o.init(),typeof Cookies!==o.u&&(o.c=Cookies.noConflict()),0===arguments.length?t=c.aPopunder:typeof t!==o.fu&&a(t).is("a")&&(i=a.Event("click",{target:t}),t=c.aPopunder),n||e)o.bindEvents(t,e,n);else if(t=typeof t===o.fu?t(i):t,o.reset(),typeof t!==o.u)for(;o.queue(t,i),o.first=!1,0<t.length;);return a},a.popunder.helper={TIMEOUT:"timeout",SWITCHER:"switcher",SIMPLE:"simple",_top:c.self,lastWin:null,lastTarget:null,last:!1,first:!0,b:"about:blank",u:"undefined",fu:"function",o:null,c:null,du:"__jqpu",ua:{ie:/msie|trident/i.test(e.userAgent),oldIE:/msie/i.test(e.userAgent),edge:/edge/i.test(e.userAgent),ff:/firefox/i.test(e.userAgent),o:/opera/i.test(e.userAgent),g:/chrome/i.test(e.userAgent),w:/webkit/i.test(e.userAgent),linux:/linux/i.test(e.userAgent),touch:"ontouchstart"in n.documentElement||/bada|blackberry|iemobile|android|iphone|ipod|ipad/i.test(e.userAgent)},m:!1,ns:"jqpu",def:{window:{toolbar:0,scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,width:(t.availWidth-122).toString(),height:(t.availHeight-122).toString(),screenX:0,screenY:0,left:0,top:0},name:"__pu",cookie:"__puc",blocktime:!1,skip:{},cb:null,popup:!1},testStack:function(t,e){var n,i=!1;for(n in t)t.hasOwnProperty(n)&&t[n]&&e[n]&&(i=t[n]);return i},init:function(){var t=this;return t.m||(t.m=t.testStack({ff:t.TIMEOUT,ie:t.SWITCHER,edge:t.SWITCHER,w:t.SWITCHER,g:t.SWITCHER,o:t.SWITCHER,linux:t.SWITCHER,touch:t.SWITCHER},t.ua)),t},queue:function(t,e){var n=!1,i=this;if(0<t.length)for(;!1===n;){var o=t.shift();n=!o||i.open(o[0],o[1]||{},t.length,e)}return 0===t.length&&(i.bg(),i.m!==i.TIMEOUT&&i.href(!0,i)),i},bindEvents:function(t,e,n){function i(t){return a.popunder(t.data.stack,!1,!1,t),!0}var o=this,r="string";return e&&o.m!==o.SWITCHER&&(e=typeof e==r?a(e):e).on("submit."+o.ns,{stack:t},i),n&&(n=typeof n==r?a(n):n).on("click."+o.ns,{stack:t},i),o},cookieCheck:function(t,e){var n=this,i=n.rand(e.cookie,!1),o=n.c.get(i),r=!1;return o?-1===o.indexOf(t)?o+=t:r=!0:o=t,n.c.set(i,o,{expires:new Date((new Date).getTime()+6e4*e.blocktime)}),r},rand:function(t,e){return(t||this.du)+(!1===e?"":Math.floor(89999999*Math.random()+1e7).toString()).replace(".","")},open:function(t,e,n,i){var o,r,s=this,u=a.extend(!0,{},s.def,e);if(s.o=t,top!==c.self)try{top.document.location.toString()&&(s._top=top)}catch(t){}return!s.testStack(u.skip,s.ua)&&((!u.blocktime||typeof s.c!==s.fu||!s.cookieCheck(t,u))&&(t!==s.du&&(s.lastTarget=t,!0===s.first&&s.m===s.SWITCHER?(i&&typeof i.target!==s.u&&(o=s.getElementUrl(i,void 0),i.preventDefault()),s.switcher.switchWindow(o,s.o,s.rand(u.name,!e.name))):!0!==s.first&&!0!==s.isMultiple()||(s.m===s.TIMEOUT?c.setTimeout((r=a.extend(!0,{},s),function(){try{r.lastWin=c.open(r.o,r.rand(u.name,!e.name),r.getOptions(u.window))||r.lastWin,r.href(n,r),typeof u.cb===r.fu&&u.cb(r.lastWin)}catch(t){}}),0):s.lastWin=s._top.window.open(s.o,s.rand(u.name,!e.name),s.getOptions(u.window))||s.lastWin),s.m!==s.TIMEOUT&&(s.href(n,s),typeof u.cb===s.fu&&u.cb(s.lastWin))),!0))},bg:function(){var t=this;return t.TIMEOUT!==t.m&&!t.lastTarget||(t.m===t.SIMPLE?(t.switcher.simple(t),c.setTimeout(function(){t.switcher.simple(t)},500)):t.m===t.TIMEOUT&&t.switcher.timeout()),t},switcher:{simple:function(t){t.ua.oldIE?(t.lastWin.blur(),t.lastWin.opener.window.focus(),c.self.window.focus(),c.focus()):n.focus()},timeout:function(){c.setTimeout(function(){var t=c.open("","_self");t&&!t.closed&&t.focus()},0)},switchWindow:function(t,e,n){c.open(t,n),c.location.assign(e)}},isMultiple:function(){return this.m===this.TIMEOUT||this.m===this.SIMPLE},href:function(t,e){return t&&e.lastTarget&&e.lastWin&&e.lastTarget!==e.b&&e.lastTarget!==e.o&&(e.lastWin.document.location.href=e.lastTarget),e},getElementUrl:function(t,e){var n,i,o=":submit, button",r=a(t.target),s=typeof e===this.u;return r.is("a")&&s?i=(n=r).attr("href"):!0!==r.is(o)?n=(r=r.parents(o)).parents("form"):(n=a(t.target.form),!r.is(o)||n&&n.length||(n=r.parents("form"))),i||0===r.length||0===n.length||"get"!==(n.prop("method")+"").toLowerCase()||"_blank"!==n.attr("target")&&!s||(i=n.attr("action")+"/?"+n.serialize()),i},reset:function(){var t=this;return t.last=!1,t.first=!0,t.lastTarget=t.lastWin=null,t},unbind:function(t,e){return this.reset(),t&&(t="string"==typeof t?a(t):t).off("submit."+this.ns),e&&((e="string"==typeof e?a(e):e).off("click."+this.ns).next(".jq-pu object").remove(),e.unwrap()),c.aPopunder=[],this},getOptions:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(e+"="+t[e]);return n.join(",")}},a});